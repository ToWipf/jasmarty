<div>
    <h3>Daylog</h3>

    <div class="list">
        <perfect-scrollbar class="pscrollConfigline">
            <ng-container *ngIf="bShowWarning">
                Es ist ein Fehler aufgetreten!
                <input type="checkbox" [(ngModel)]="bShowWarning" />
            </ng-container>

            <div class="configline">
                <div class="iconbox">
                    Neu Laden:
                    <button class="btn btn-wipf-default btn-for-icon" (click)="ngOnInit()">
                        <mat-icon svgIcon="restart" aria-hidden="false" title="neu Laden"></mat-icon>
                    </button>

                    <br>
                    Zeige Alles:
                    <button class="btn btn-wipf-default btn-for-icon" *ngIf="bShowAllTable" (click)="showAllTableColumns()">
                        <mat-icon svgIcon="ok" aria-hidden="false" title="neu Laden"></mat-icon>
                    </button>
                    <button class="btn btn-wipf-default btn-for-icon" *ngIf="!bShowAllTable" (click)="showAllTableColumns()">
                        <mat-icon svgIcon="round" aria-hidden="false" title="neu Laden"></mat-icon>
                    </button>
                </div>

                <div class="iconbox">
                    Typ VW:
                    <button class="btn btn-wipf-default btn-for-icon" (click)="openDialogTypeVW()">
                        <mat-icon svgIcon="support" aria-hidden="false" title="Typenverwaltung öffnen"></mat-icon>
                    </button>

                    <br>
                    Alle Events:
                    <button class="btn btn-wipf-default btn-for-icon" (click)="loadAllEventsViaVar()">
                        <mat-icon svgIcon="download" aria-hidden="false" title="Lade alle Events"></mat-icon>
                    </button>
                </div>

                <div class="box" *ngIf="bShowDayTable">
                    <mat-form-field>
                        <mat-label>Tag Filtern</mat-label>
                        <input matInput (ngModelChange)="dayFilter()" [(ngModel)]="sFilterDay">
                    </mat-form-field>
                    <!-- Filter Tag: <input (ngModelChange)="applyFilter()" [(ngModel)]="sFilterDay" /> -->
                </div>

                <div class="box">
                    <mat-form-field>
                        <mat-label>Event Filtern</mat-label>
                        <input matInput (ngModelChange)="applyFilter()" [(ngModel)]="sFilterTextEvent">
                    </mat-form-field>
                </div>
                <div class="box" *ngIf="!bShowDayTable">
                    <mat-form-field appearance="fill">
                        <mat-label>Event Typ Filtern</mat-label>
                        <mat-select [(value)]="selectedEventTypeFilter">
                            <mat-option [value]="undefined">Kein Filter</mat-option>
                            <mat-option *ngFor="let itemEvent of typelistForEventFilter" [value]="itemEvent">{{itemEvent.type}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
        </perfect-scrollbar>

        <ng-scrollbar class="pscrollTabellen" track="horizontal">
            <div class="gridRow_ohne_rand">
                <div class="gridCol" [ngClass]="{'hide': !bShowDayTable }">
                    <ng-scrollbar class="pscroll">
                        <table mat-table [dataSource]="daylistDataSource" matSort matSortActive="date" matSortDirection="desc" class="mat-elevation-z8">
                            <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
                                <td mat-cell *matCellDef="let element">{{ element.id }}</td>
                            </ng-container>

                            <ng-container matColumnDef="date">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Datum</th>
                                <!-- <td mat-cell *matCellDef="let element">{{element.date * 1000 | date: 'dd.MM.yyyy'}}</td> -->
                                <td mat-cell *matCellDef="let element">{{element.date}}</td>
                            </ng-container>

                            <ng-container matColumnDef="day">
                                <th mat-header-cell *matHeaderCellDef>Tag</th>
                                <!-- <td mat-cell *matCellDef="let element">{{element.date * 1000 | date: 'dd.MM.yyyy'}}</td> -->
                                <td mat-cell *matCellDef="let element">{{element.extrafeld_wochentag}}</td>
                            </ng-container>

                            <ng-container matColumnDef="tagestext">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                    Tagestext
                                </th>
                                <td mat-cell *matCellDef="let element">
                                    {{ element.tagestext }}
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="userid">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Userid</th>
                                <td mat-cell *matCellDef="let element">{{ element.userid }}</td>
                            </ng-container>

                            <ng-container matColumnDef="button">
                                <th th mat-header-cell *matHeaderCellDef>
                                    <div class="tableVW">
                                        <button class="btn btn-wipf-default btn-for-icon" (click)="newDay()">
                                            <mat-icon svgIcon="document" aria-hidden="false" title="Neuen Tag erstellen"></mat-icon>
                                        </button>
                                        ∑: {{daylistDataSource?._data?._value?.length}}
                                    </div>
                                </th>
                                <td mat-cell *matCellDef="let element">
                                    <button class="btn btn-wipf-default btn-for-icon" (click)="editDay(element)">
                                        <mat-icon svgIcon="edit" aria-hidden="false" title="Bearbeiten"></mat-icon>
                                    </button>
                                    <!-- <button class="btn btn-wipf-default" (click)="loadEventsByDay(element)">
                                    <mat-icon svgIcon="extern_link" aria-hidden="false" title="Tag anzeigen"></mat-icon>
                                </button> -->
                                    <!-- <button class="btn btn-wipf-default" (click)="newEvent(element)">
                                    Event erstellen
                                </button> -->
                                    <button class="btn btn-wipf-default btn-for-icon" (click)="deleteDay(element)">
                                        <mat-icon svgIcon="trash" aria-hidden="false" title="Löschen"></mat-icon>
                                    </button>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="daylistDisplayedColumns"></tr>
                            <tr mat-row (click)="loadEventsByDaySetVar(row)" [class.day-row-is-clicked]="dateForLoad == (row)" *matRowDef="let row; columns: daylistDisplayedColumns"></tr>
                        </table>
                    </ng-scrollbar>
                </div>
                <div class="gridCol">
                    <ng-scrollbar class="pscroll">
                        <app-daylog-eventlist [filterEventType]="selectedEventTypeFilter" [filterTextEvent]="sFilterTextEvent" [showAllTableColumns]="bShowAllTable" [dateForLoad]="dateForLoad" (daylogTypes)="daylogTypes"></app-daylog-eventlist>
                    </ng-scrollbar>
                </div>
            </div>
        </ng-scrollbar>
    </div>
</div>